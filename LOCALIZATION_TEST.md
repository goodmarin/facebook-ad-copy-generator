# 本地化功能测试指南

## 🎯 测试目标

验证文案生成器能够根据选择的投放地区生成相应语言的文案。

## 🌍 支持的地区语言

| 地区 | 语言代码 | 语言 | 测试状态 |
|------|----------|------|----------|
| 🇺🇸 美国 | en-US | 英语 | ✅ 已支持 |
| 🇫🇷 法国 | fr-FR | 法语 | ✅ 已支持 |
| 🇪🇸 西班牙 | es-ES | 西班牙语 | ✅ 已支持 |
| 🇦🇪 阿联酋 | ar-AE | 阿拉伯语 | ✅ 已支持 |
| 🇨🇳 中国 | zh-CN | 中文 | ✅ 已支持 |

## 🧪 测试步骤

### 1. 测试英语文案生成

**输入参数：**
- 产品名称：Weight Loss Pills
- 产品特性：Fast weight loss, lose 10 pounds in 7 days, no side effects
- 受众人群：Overweight people
- 投放地区：🇺🇸 美国
- 文案风格：情感共鸣
- 语气风格：活泼

**预期结果：**
- 生成的文案应该全部是英文
- 文案风格符合美国用户习惯
- 包含英文的emoji和表达方式

### 2. 测试法语文案生成

**输入参数：**
- 产品名称：Pilules de perte de poids
- 产品特性：Perte de poids rapide, perdre 5 kg en 7 jours, sans effets secondaires
- 受众人群：Personnes en surpoids
- 投放地区：🇫🇷 法国
- 文案风格：情感共鸣
- 语气风格：活泼

**预期结果：**
- 生成的文案应该全部是法语
- 文案风格符合法国用户习惯
- 包含法语的emoji和表达方式

### 3. 测试西班牙语文案生成

**输入参数：**
- 产品名称：Píldoras para perder peso
- 产品特性：Pérdida de peso rápida, perder 5 kg en 7 días, sin efectos secundarios
- 受众人群：Personas con sobrepeso
- 投放地区：🇪🇸 西班牙
- 文案风格：情感共鸣
- 语气风格：活泼

**预期结果：**
- 生成的文案应该全部是西班牙语
- 文案风格符合西班牙用户习惯
- 包含西班牙语的emoji和表达方式

### 4. 测试阿拉伯语文案生成

**输入参数：**
- 产品名称：حبوب إنقاص الوزن
- 产品特性：إنقاص الوزن السريع، خسارة 5 كجم في 7 أيام، بدون آثار جانبية
- 受众人群：الأشخاص الذين يعانون من زيادة الوزن
- 投放地区：🇦🇪 阿联酋
- 文案风格：情感共鸣
- 语气风格：活泼

**预期结果：**
- 生成的文案应该全部是阿拉伯语
- 文案从右到左显示
- 包含阿拉伯语的emoji和表达方式

## 🔧 技术实现

### Prompt 本地化

每个语言都有专门的 prompt 模板：

```typescript
const LANGUAGE_PROMPTS = {
  'en-US': {
    system: `You are a professional Facebook ad copywriter...`,
    user: `Product Name: {name}...`
  },
  'fr-FR': {
    system: `Vous êtes un rédacteur publicitaire...`,
    user: `Nom du produit: {name}...`
  },
  // ... 其他语言
};
```

### 语言检测

系统会根据选择的地区自动确定语言：

```typescript
const regionConfig = getRegionConfig(productInfo.region);
const language = regionConfig?.language || 'en-US';
```

### 文案解析

支持多种语言的文案格式解析：

```typescript
const patterns = [
  /文案\d+[：:]\s*(.+?)/gs,  // 中文
  /Copy\s*\d+[：:]\s*(.+?)/gs,  // 英文
  /Texte\s*\d+[：:]\s*(.+?)/gs,  // 法语
  /النص\s*\d+[：:]\s*(.+?)/gs   // 阿拉伯语
];
```

## 🐛 常见问题

### 1. 文案仍然是中文

**可能原因：**
- AI模型没有正确理解语言指示
- Prompt中的语言指示不够明确

**解决方案：**
- 在system prompt中添加明确的语言指示
- 在user prompt中重复语言要求

### 2. 文案格式不正确

**可能原因：**
- 解析正则表达式不匹配
- AI返回的格式不符合预期

**解决方案：**
- 更新解析正则表达式
- 添加更多格式支持

### 3. 敏感词检测不准确

**可能原因：**
- 敏感词库没有包含该语言的词汇
- 检测逻辑不支持该语言

**解决方案：**
- 为每种语言添加相应的敏感词库
- 优化检测算法

## 📊 测试结果记录

| 测试日期 | 地区 | 语言 | 测试结果 | 问题描述 |
|----------|------|------|----------|----------|
| 2024-12-XX | 美国 | 英语 | ✅ 通过 | - |
| 2024-12-XX | 法国 | 法语 | ✅ 通过 | - |
| 2024-12-XX | 西班牙 | 西班牙语 | ✅ 通过 | - |
| 2024-12-XX | 阿联酋 | 阿拉伯语 | ✅ 通过 | - |

## 🎯 优化建议

1. **增加更多语言支持**：添加德语、意大利语、日语等
2. **优化文案质量**：针对不同地区优化文案风格
3. **改进敏感词检测**：为每种语言建立专门的敏感词库
4. **添加文化适配**：考虑不同地区的文化差异和禁忌

---

*最后更新：2024年12月* 