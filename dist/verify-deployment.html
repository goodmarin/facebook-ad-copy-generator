<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>验证 GitHub Pages 部署</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .test-item { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .pending { background-color: #fff3cd; border-color: #ffeaa7; }
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>🔍 GitHub Pages 部署验证</h1>
    
    <div class="test-item pending" id="test-website">
        <h3>📱 1. 网站访问测试</h3>
        <p>检查主网站是否可以正常访问...</p>
        <button onclick="testWebsite()">测试网站访问</button>
        <div id="website-result"></div>
    </div>

    <div class="test-item pending" id="test-api">
        <h3>🤖 2. API 功能测试</h3>
        <p>测试 DeepSeek API 效果预测功能...</p>
        <button onclick="testAPI()">测试 API 功能</button>
        <div id="api-result"></div>
    </div>

    <div class="test-item pending" id="test-integration">
        <h3>🔗 3. 组件集成测试</h3>
        <p>检查 React 组件是否正确加载...</p>
        <button onclick="testIntegration()">测试组件集成</button>
        <div id="integration-result"></div>
    </div>

    <script>
        async function testWebsite() {
            const resultDiv = document.getElementById('website-result');
            const testDiv = document.getElementById('test-website');
            
            try {
                resultDiv.innerHTML = '<p>🔄 正在测试网站访问...</p>';
                
                const response = await fetch('https://goodmarin.github.io/facebook-ad-copy-generator/');
                
                if (response.ok) {
                    const html = await response.text();
                    const hasTitle = html.includes('Facebook') && html.includes('文案生成器');
                    
                    if (hasTitle) {
                        testDiv.className = 'test-item success';
                        resultDiv.innerHTML = `
                            <p>✅ 网站访问成功！</p>
                            <p>📊 状态码: ${response.status}</p>
                            <p>🎯 页面标题检测: 通过</p>
                        `;
                    } else {
                        testDiv.className = 'test-item error';
                        resultDiv.innerHTML = `
                            <p>⚠️ 网站可访问但内容异常</p>
                            <p>📊 状态码: ${response.status}</p>
                            <p>❌ 页面标题检测: 失败</p>
                        `;
                    }
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                testDiv.className = 'test-item error';
                resultDiv.innerHTML = `
                    <p>❌ 网站访问失败</p>
                    <p>🔴 错误: ${error.message}</p>
                `;
            }
        }

        async function testAPI() {
            const resultDiv = document.getElementById('api-result');
            const testDiv = document.getElementById('test-api');
            
            try {
                resultDiv.innerHTML = '<p>🔄 正在测试 DeepSeek API...</p>';
                
                const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer sk-674b29e0b86846bca55195b66eb3e3aa'
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            {
                                role: 'system',
                                content: '你是一个专业的Facebook广告效果预测专家。'
                            },
                            {
                                role: 'user',
                                content: '请对以下广告文案进行效果预测：🚀 智能手机新品上市，限时优惠！请返回格式：CTR: [百分比] 评分: [星级] 建议: [建议]'
                            }
                        ],
                        max_tokens: 200,
                        temperature: 0.3
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    const content = data.choices[0]?.message?.content;
                    
                    if (content) {
                        testDiv.className = 'test-item success';
                        resultDiv.innerHTML = `
                            <p>✅ API 测试成功！</p>
                            <p>📊 状态码: ${response.status}</p>
                            <p>🤖 AI 回复:</p>
                            <pre>${content}</pre>
                        `;
                    } else {
                        throw new Error('API 返回数据格式异常');
                    }
                } else {
                    throw new Error(`API 调用失败: ${response.status}`);
                }
            } catch (error) {
                testDiv.className = 'test-item error';
                resultDiv.innerHTML = `
                    <p>❌ API 测试失败</p>
                    <p>🔴 错误: ${error.message}</p>
                `;
            }
        }

        async function testIntegration() {
            const resultDiv = document.getElementById('integration-result');
            const testDiv = document.getElementById('test-integration');
            
            try {
                resultDiv.innerHTML = '<p>🔄 正在检查组件集成...</p>';
                
                // 检查主要 JavaScript 文件
                const jsResponse = await fetch('https://goodmarin.github.io/facebook-ad-copy-generator/assets/js/index-956fad1e.js');
                
                if (jsResponse.ok) {
                    const jsContent = await jsResponse.text();
                    
                    // 检查关键组件和功能
                    const hasDeepSeek = jsContent.toLowerCase().includes('deepseek');
                    const hasReact = jsContent.includes('React');
                    const hasComponents = jsContent.includes('OutputDisplay') || jsContent.includes('output');
                    
                    testDiv.className = 'test-item success';
                    resultDiv.innerHTML = `
                        <p>✅ 组件集成检查完成！</p>
                        <p>📊 JavaScript 文件: 已加载</p>
                        <p>🤖 DeepSeek 集成: ${hasDeepSeek ? '✅ 包含' : '❌ 缺失'}</p>
                        <p>⚛️ React 组件: ${hasReact ? '✅ 包含' : '❌ 缺失'}</p>
                        <p>🔗 输出组件: ${hasComponents ? '✅ 包含' : '❌ 缺失'}</p>
                        <p>📁 文件大小: ${(jsContent.length / 1024).toFixed(1)} KB</p>
                    `;
                } else {
                    throw new Error(`JavaScript 文件加载失败: ${jsResponse.status}`);
                }
            } catch (error) {
                testDiv.className = 'test-item error';
                resultDiv.innerHTML = `
                    <p>❌ 组件集成检查失败</p>
                    <p>🔴 错误: ${error.message}</p>
                `;
            }
        }

        // 自动运行所有测试
        window.onload = function() {
            setTimeout(() => {
                testWebsite();
                setTimeout(() => {
                    testAPI();
                    setTimeout(() => {
                        testIntegration();
                    }, 2000);
                }, 2000);
            }, 1000);
        };
    </script>
</body>
</html>
