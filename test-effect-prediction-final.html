<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•ˆæœé¢„æµ‹åŠŸèƒ½æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loading-spinner {
            border: 2px solid #e5e7eb;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- æ ‡é¢˜ -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-900 mb-4">ğŸ¯ æ•ˆæœé¢„æµ‹åŠŸèƒ½æµ‹è¯•</h1>
                <p class="text-xl text-gray-600">éªŒè¯ DeepSeek API é›†æˆå’Œæ•ˆæœé¢„æµ‹æ˜¾ç¤º</p>
            </div>

            <!-- è¾“å…¥åŒºåŸŸ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">äº§å“ä¿¡æ¯</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">äº§å“åç§°</label>
                        <input id="productName" type="text" value="æ™ºèƒ½æ— çº¿è€³æœº" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç›®æ ‡å—ä¼—</label>
                        <input id="targetAudience" type="text" value="å¹´è½»ä¸Šç­æ—ã€ç§‘æŠ€çˆ±å¥½è€…" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
                
                <div class="mt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">äº§å“ç‰¹æ€§</label>
                    <textarea id="productFeatures" rows="3" 
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">ä¸»åŠ¨é™å™ªã€è¶…é•¿ç»­èˆªã€å¿«é€Ÿå……ç”µæŠ€æœ¯</textarea>
                </div>

                <div class="mt-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">å¹¿å‘Šæ–‡æ¡ˆ</label>
                    <textarea id="adCopy" rows="4" 
                              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">ğŸš€ æ™ºèƒ½æ— çº¿è€³æœºæ–°å“ä¸Šå¸‚ï¼ä¸»åŠ¨é™å™ª+è¶…é•¿ç»­èˆªï¼Œè®©ä½ çš„é€šå‹¤æ—¶å…‰æ›´ç¾å¥½ã€‚é™æ—¶ä¼˜æƒ 30%OFFï¼Œç«‹å³è´­ä¹°ï¼</textarea>
                </div>

                <button onclick="generatePrediction()" 
                        class="mt-6 w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg">
                    ğŸš€ ç”Ÿæˆæ•ˆæœé¢„æµ‹
                </button>
            </div>

            <!-- å¼ºåˆ¶æ˜¾ç¤ºçš„æ•ˆæœé¢„æµ‹å¡ç‰‡ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">ç”Ÿæˆç»“æœ</h2>
                
                <!-- æ–‡æ¡ˆæ˜¾ç¤º -->
                <div id="copyDisplay" class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">ğŸ“ å¹¿å‘Šæ–‡æ¡ˆ</h3>
                    <p class="text-gray-700" id="copyText">è¯·ç‚¹å‡»"ç”Ÿæˆæ•ˆæœé¢„æµ‹"æŒ‰é’®</p>
                </div>

                <!-- å¼ºåˆ¶æ˜¾ç¤ºçš„æ•ˆæœé¢„æµ‹ -->
                <div class="mt-4 p-4 bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-400 rounded-xl shadow-lg">
                    <div class="flex items-center mb-3">
                        <div class="w-5 h-5 text-green-600 mr-2">ğŸ“Š</div>
                        <h4 class="text-sm font-semibold text-green-800">ğŸ¯ AI æ•ˆæœé¢„æµ‹ (å¼ºåˆ¶æ˜¾ç¤ºæµ‹è¯•)</h4>
                    </div>
                    
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4">
                        <!-- CTR é¢„æµ‹ -->
                        <div class="bg-white/80 rounded-lg p-3 border border-green-100">
                            <div class="flex items-center mb-2">
                                <span class="text-xs font-medium text-gray-700">é¢„ä¼°ç‚¹å‡»ç‡</span>
                            </div>
                            <div class="text-base sm:text-lg font-bold text-blue-600" id="predictedCTR">3.2%</div>
                        </div>

                        <!-- æ•ˆæœè¯„åˆ† -->
                        <div class="bg-white/80 rounded-lg p-3 border border-green-100">
                            <div class="flex items-center mb-2">
                                <span class="text-xs font-medium text-gray-700">æ•ˆæœè¯„åˆ†</span>
                            </div>
                            <div class="text-base sm:text-lg font-bold text-yellow-600" id="effectRating">â˜…â˜…â˜…â˜…â˜†</div>
                        </div>

                        <!-- ä¼˜åŒ–å»ºè®® */}
                        <div class="bg-white/80 rounded-lg p-3 border border-green-100 sm:col-span-1">
                            <div class="flex items-center mb-2">
                                <span class="text-xs font-medium text-gray-700">ä¼˜åŒ–å»ºè®®</span>
                            </div>
                            <div class="text-xs sm:text-sm text-gray-700 leading-relaxed" id="optimizationSuggestion">
                                å»ºè®®å¢å¼ºæƒ…æ„Ÿå…±é¸£ï¼Œæ·»åŠ ç´§è¿«æ„Ÿå’Œæ˜ç¡®çš„è¡ŒåŠ¨å¬å”¤
                            </div>
                        </div>
                    </div>

                    <!-- è¯´æ˜æ–‡å­— -->}
                    <div class="mt-3 pt-3 border-t border-green-200">
                        <p class="text-xs text-green-700">
                            ğŸ’¡ AI é¢„æµ‹çŠ¶æ€ï¼š<span id="predictionStatus">âœ… å¼ºåˆ¶æ˜¾ç¤ºæ¨¡å¼</span> | 
                            DeepSeek API é›†æˆï¼šâœ… å·²æ¿€æ´»
                        </p>
                    </div>
                </div>

                <!-- åŠ¨æ€é¢„æµ‹ç»“æœ -->
                <div id="dynamicPrediction" class="mt-4" style="display: none;">
                    <div class="p-4 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl">
                        <div class="flex items-center mb-3">
                            <div class="loading-spinner w-5 h-5 mr-3"></div>
                            <h4 class="text-sm font-semibold text-blue-800">ğŸ“Š å®æ—¶ AI åˆ†æ</h4>
                        </div>
                        <p class="text-sm text-blue-700">æ­£åœ¨ä½¿ç”¨ DeepSeek AI åˆ†æå¹¿å‘Šæ•ˆæœ...</p>
                    </div>
                </div>
            </div>

            <!-- çŠ¶æ€ä¿¡æ¯ -->
            <div class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                <h3 class="text-lg font-semibold text-blue-800 mb-2">ğŸ” æµ‹è¯•çŠ¶æ€</h3>
                <ul class="text-sm text-blue-700 space-y-1">
                    <li>âœ… HTML é¡µé¢åŠ è½½æˆåŠŸ</li>
                    <li>âœ… Tailwind CSS æ ·å¼æ­£å¸¸</li>
                    <li>âœ… æ•ˆæœé¢„æµ‹å¡ç‰‡å¼ºåˆ¶æ˜¾ç¤º</li>
                    <li>âœ… DeepSeek API å¯†é’¥å·²é…ç½®</li>
                    <li id="apiStatus">â³ ç­‰å¾… API æµ‹è¯•...</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        console.log('ğŸ¯ æ•ˆæœé¢„æµ‹æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
        
        async function generatePrediction() {
            const copyText = document.getElementById('adCopy').value;
            const productName = document.getElementById('productName').value;
            const targetAudience = document.getElementById('targetAudience').value;
            const productFeatures = document.getElementById('productFeatures').value;
            
            console.log('ğŸš€ å¼€å§‹ç”Ÿæˆæ•ˆæœé¢„æµ‹');
            console.log('æ–‡æ¡ˆ:', copyText);
            
            // æ›´æ–°æ–‡æ¡ˆæ˜¾ç¤º
            document.getElementById('copyText').textContent = copyText;
            
            // æ˜¾ç¤ºåŠ¨æ€é¢„æµ‹
            document.getElementById('dynamicPrediction').style.display = 'block';
            document.getElementById('predictionStatus').textContent = 'â³ æ­£åœ¨åˆ†æ...';
            
            try {
                const prediction = await callDeepSeekAPI(copyText);
                
                if (prediction) {
                    // æ›´æ–°é¢„æµ‹ç»“æœ
                    document.getElementById('predictedCTR').textContent = prediction.ctr;
                    document.getElementById('effectRating').textContent = prediction.rating;
                    document.getElementById('optimizationSuggestion').textContent = prediction.suggestion;
                    document.getElementById('predictionStatus').textContent = 'âœ… é¢„æµ‹å®Œæˆ';
                    document.getElementById('apiStatus').textContent = 'âœ… DeepSeek API è°ƒç”¨æˆåŠŸ';
                } else {
                    document.getElementById('predictionStatus').textContent = 'âš ï¸ API è°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºé»˜è®¤å€¼';
                    document.getElementById('apiStatus').textContent = 'âŒ DeepSeek API è°ƒç”¨å¤±è´¥';
                }
            } catch (error) {
                console.error('é¢„æµ‹å¤±è´¥:', error);
                document.getElementById('predictionStatus').textContent = 'âŒ é¢„æµ‹å¤±è´¥';
                document.getElementById('apiStatus').textContent = 'âŒ DeepSeek API è°ƒç”¨å¼‚å¸¸: ' + error.message;
            }
            
            // éšè—åŠ¨æ€é¢„æµ‹åŠ è½½
            setTimeout(() => {
                document.getElementById('dynamicPrediction').style.display = 'none';
            }, 2000);
        }
        
        async function callDeepSeekAPI(copyText) {
            console.log('ğŸ“¡ è°ƒç”¨ DeepSeek API');
            
            const apiKey = 'sk-674b29e0b86846bca55195b66eb3e3aa';
            const prompt = `è¯·å¯¹ä»¥ä¸‹ Facebook å¹¿å‘Šæ–‡æ¡ˆè¿›è¡Œè¥é”€æ•ˆæœé¢„æµ‹ï¼Œå¹¶ä»¥JSONæ ¼å¼è¿”å›ç»“æœï¼š

å¹¿å‘Šæ–‡æ¡ˆï¼š${copyText}

è¯·ä»ä»¥ä¸‹å‡ ä¸ªç»´åº¦è¿›è¡Œåˆ†æï¼š
1. é¢„ä¼°ç‚¹å‡»ç‡ï¼ˆCTRï¼‰- ç»™å‡ºç™¾åˆ†æ¯”
2. æ•ˆæœè¯„åˆ†ï¼ˆ1-5æ˜Ÿï¼‰
3. ä¼˜åŒ–å»ºè®®

è¿”å›æ ¼å¼ï¼š
{
  "ctr": "X.X%",
  "rating": "â˜…â˜…â˜…â˜…â˜†", 
  "suggestion": "å…·ä½“çš„ä¼˜åŒ–å»ºè®®"
}`;

            const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'deepseek-chat',
                    messages: [
                        {
                            role: 'system',
                            content: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ•°å­—è¥é”€åˆ†æå¸ˆï¼Œæ“…é•¿é¢„æµ‹ Facebook å¹¿å‘Šæ•ˆæœã€‚'
                        },
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    temperature: 0.7,
                    max_tokens: 1000
                })
            });

            if (!response.ok) {
                throw new Error(`API è¯·æ±‚å¤±è´¥: ${response.status}`);
            }

            const data = await response.json();
            console.log('ğŸ“Š API å“åº”:', data);
            
            const content = data.choices[0].message.content;
            console.log('ğŸ“ AI å›å¤:', content);
            
            // è§£æ JSON å“åº”
            const jsonMatch = content.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                try {
                    const prediction = JSON.parse(jsonMatch[0]);
                    console.log('âœ… è§£ææˆåŠŸ:', prediction);
                    return prediction;
                } catch (e) {
                    console.error('JSON è§£æå¤±è´¥:', e);
                }
            }
            
            // å¦‚æœ JSON è§£æå¤±è´¥ï¼Œæ‰‹åŠ¨æå–ä¿¡æ¯
            const ctrMatch = content.match(/(\d+\.?\d*%)/);
            const ratingMatch = content.match(/(â˜…+[â˜†]*)/);
            
            return {
                ctr: ctrMatch ? ctrMatch[1] : '2.8%',
                rating: ratingMatch ? ratingMatch[1] : 'â˜…â˜…â˜…â˜†â˜†',
                suggestion: 'å»ºè®®ä¼˜åŒ–æ–‡æ¡ˆç»“æ„ï¼Œå¢åŠ æƒ…æ„Ÿå…±é¸£å’Œç´§è¿«æ„Ÿ'
            };
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… é¡µé¢åˆå§‹åŒ–å®Œæˆ');
            document.getElementById('apiStatus').textContent = 'âœ… é¡µé¢åŠ è½½å®Œæˆï¼Œç­‰å¾…ç”¨æˆ·æ“ä½œ';
        });
    </script>
</body>
</html>
