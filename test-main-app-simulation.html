<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»åº”ç”¨åœºæ™¯æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        button { background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 5px; }
        .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px; white-space: pre-wrap; font-family: monospace; }
        .error { background: #f8d7da; color: #721c24; }
        .success { background: #d4edda; color: #155724; }
    </style>
</head>
<body>
    <h1>ä¸»åº”ç”¨åœºæ™¯æµ‹è¯•</h1>
    
    <div class="test-section">
        <h3>1. æ•ˆæœé¢„æµ‹APIæµ‹è¯•ï¼ˆæ¨¡æ‹Ÿä¸»åº”ç”¨ï¼‰</h3>
        <button onclick="testEffectPrediction()">æµ‹è¯•æ•ˆæœé¢„æµ‹</button>
        <div id="effect-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h3>2. æ–‡æ¡ˆç”ŸæˆAPIæµ‹è¯•ï¼ˆæ¨¡æ‹Ÿä¸»åº”ç”¨ï¼‰</h3>
        <button onclick="testCopyGeneration()">æµ‹è¯•æ–‡æ¡ˆç”Ÿæˆ</button>
        <div id="copy-result" class="result"></div>
    </div>

    <script>
        const apiKey = 'sk-674b29e0b86846bca55195b66eb3e3aa';
        
        async function testEffectPrediction() {
            const result = document.getElementById('effect-result');
            result.textContent = 'æµ‹è¯•ä¸­...';
            result.className = 'result';
            
            try {
                const testCopy = 'âœ¨ Elevate your sound game! Crystal-clear audio, Active Noise Cancellation, and all-day comfort. â­ Fast charging means more music, less waiting. ğŸ§ Limited-time discountâ€”upgrade your vibe today!';
                
                const prompt = `è¯·å¯¹ä»¥ä¸‹ Facebook å¹¿å‘Šæ–‡æ¡ˆè¿›è¡Œè¥é”€æ•ˆæœé¢„æµ‹ï¼Œè¾“å‡ºæ ¼å¼å¦‚ä¸‹ï¼š
- é¢„ä¼°ç‚¹å‡»ç‡ï¼ˆCTRï¼‰ç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚ 3.2%ï¼‰
- æ•ˆæœè¯„åˆ†ï¼ˆ1~5æ˜Ÿï¼‰
- ç®€çŸ­ä¼˜åŒ–å»ºè®®

æ–‡æ¡ˆå†…å®¹ï¼šã€${testCopy}ã€

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹æ ¼å¼è¿”å›ï¼Œä¸è¦æ·»åŠ å…¶ä»–å†…å®¹ï¼š
CTR: [ç™¾åˆ†æ¯”]
è¯„åˆ†: [æ˜Ÿçº§]
å»ºè®®: [ä¸€å¥è¯å»ºè®®]`;

                const requestBody = {
                    model: 'deepseek-chat',
                    messages: [
                        {
                            role: 'system',
                            content: 'ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„Facebookå¹¿å‘Šæ•ˆæœé¢„æµ‹ä¸“å®¶ï¼Œèƒ½å¤Ÿå‡†ç¡®è¯„ä¼°å¹¿å‘Šæ–‡æ¡ˆçš„è¥é”€æ•ˆæœã€‚'
                        },
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    max_tokens: 150,
                    temperature: 0.1,
                    top_p: 0.8
                };

                const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`APIé”™è¯¯: ${response.status} - ${JSON.stringify(errorData)}`);
                }

                const data = await response.json();
                const content = data.choices[0]?.message?.content;
                
                if (!content) {
                    throw new Error('æ•ˆæœé¢„æµ‹AIæœªè¿”å›æœ‰æ•ˆå†…å®¹');
                }

                result.textContent = `æ•ˆæœé¢„æµ‹æµ‹è¯•æˆåŠŸ!\n\nAIè¿”å›å†…å®¹:\n${content}`;
                result.className = 'result success';
                
            } catch (error) {
                result.textContent = `æ•ˆæœé¢„æµ‹æµ‹è¯•å¤±è´¥: ${error.message}`;
                result.className = 'result error';
                console.error('æ•ˆæœé¢„æµ‹æµ‹è¯•é”™è¯¯:', error);
            }
        }
        
        async function testCopyGeneration() {
            const result = document.getElementById('copy-result');
            result.textContent = 'æµ‹è¯•ä¸­...';
            result.className = 'result';
            
            try {
                const prompt = `Create 3 engaging Facebook ad copies in English for:
Product: Wireless Headphones
Features: Crystal-clear audio, Active Noise Cancellation, all-day comfort
Audience: Music lovers and professionals
Style: Modern and premium
Promotion: Limited-time discount

Requirements:
- 100% English, no Chinese characters
- 120-180 characters each
- Include relevant emojis naturally throughout the copy
- Use emotional triggers and compelling call-to-action
- Format: Copy 1: [content] | Copy 2: [content] | Copy 3: [content]`;

                const requestBody = {
                    model: 'deepseek-chat',
                    messages: [
                        {
                            role: 'system',
                            content: 'You are a creative English Facebook ad copywriter specializing in engaging, conversion-focused content. Generate 100% English content only, no Chinese characters. Use relevant emojis naturally, create emotional connections and include compelling calls-to-action.'
                        },
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    max_tokens: 600,
                    temperature: 0.7,
                    top_p: 0.8
                };

                const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`APIé”™è¯¯: ${response.status} - ${JSON.stringify(errorData)}`);
                }

                const data = await response.json();
                const content = data.choices[0]?.message?.content;
                
                if (!content) {
                    throw new Error('æ–‡æ¡ˆç”ŸæˆAIæœªè¿”å›æœ‰æ•ˆå†…å®¹');
                }

                const processedContent = cleanEmojis(content);
                
                result.textContent = `æ–‡æ¡ˆç”Ÿæˆæµ‹è¯•æˆåŠŸ!\n\nåŸå§‹å†…å®¹:\n${content}\n\nå¤„ç†åå†…å®¹:\n${processedContent}`;
                result.className = 'result success';
                
            } catch (error) {
                result.textContent = `æ–‡æ¡ˆç”Ÿæˆæµ‹è¯•å¤±è´¥: ${error.message}`;
                result.className = 'result error';
                console.error('æ–‡æ¡ˆç”Ÿæˆæµ‹è¯•é”™è¯¯:', error);
            }
        }
        
        function cleanEmojis(text) {
            console.log('cleanEmojis è¾“å…¥:', text);
            
            let cleanedText = text;
            
            // ç›´æ¥ç§»é™¤æ‰€æœ‰å·²çŸ¥çš„é—®é¢˜emojiå’Œç¬¦å·
            const symbolsToRemove = [
                'â“', 'â”', 'â•', 'â–', 'ğŸ”¥', 'ğŸ’¥', 'ğŸ’¢', 'ğŸ’£', 'ğŸ’¤', 'â™ª', 'â™«', 'â™¬', 'â™©', 'ğŸ’', 'â³', 'â†’',
                'âœ¨', 'â­', 'ğŸ’¡', 'ğŸ¯', 'ğŸš€', 'ğŸ’ª', 'ğŸ§', 'ğŸµ', 'ğŸ¶', 'ğŸ¤', 'ğŸ¼', 'ğŸ¹', 'ğŸ¥', 'ğŸ·', 'ğŸº', 'ğŸ¸', 'ğŸ»',
                'ğŸ®', 'ğŸ²', 'ğŸ§©', 'ğŸ³', 'ğŸª', 'ğŸ­', 'ğŸ¨', 'ğŸ¬', 'âš™ï¸', 'ğŸ­', 'ğŸª', 'ğŸ¨', 'ğŸ¬', 'ğŸ¤', 'ğŸ§', 'ğŸ¼', 'ğŸ¹',
                'ğŸ¥', 'ğŸ·', 'ğŸº', 'ğŸ¸', 'ğŸ»', 'ğŸ®', 'ğŸ²', 'ğŸ§©', 'ğŸ¯', 'ğŸ³', 'ğŸª', 'ğŸ­', 'ğŸ¨', 'ğŸ¬', 'ğŸ¤', 'ğŸ§', 'ğŸ¼',
                'ğŸ¹', 'ğŸ¥', 'ğŸ·', 'ğŸº', 'ğŸ¸', 'ğŸ»', 'ğŸ®', 'ğŸ²', 'ğŸ§©', 'ğŸ¯', 'ğŸ³', 'ğŸª', 'ğŸ­', 'ğŸ¨', 'ğŸ¬', 'ğŸ¤', 'ğŸ§',
                'ğŸ¼', 'ğŸ¹', 'ğŸ¥', 'ğŸ·', 'ğŸº', 'ğŸ¸', 'ğŸ»', 'ğŸ®', 'ğŸ²', 'ğŸ§©', 'ğŸ¯', 'ğŸ³', 'ğŸª', 'ğŸ­', 'ğŸ¨', 'ğŸ¬', 'ğŸ¤',
                'ğŸ§', 'ğŸ¼', 'ğŸ¹', 'ğŸ¥', 'ğŸ·', 'ğŸº', 'ğŸ¸', 'ğŸ»', 'ğŸ®', 'ğŸ²', 'ğŸ§©', 'ğŸ¯', 'ğŸ³', 'ğŸª', 'ğŸ­', 'ğŸ¨', 'ğŸ¬'
            ];
            
            symbolsToRemove.forEach(symbol => {
                cleanedText = cleanedText.replace(new RegExp(symbol, 'g'), '');
            });
            
            console.log('cleanEmojis è¾“å‡º:', cleanedText);
            return cleanedText;
        }
    </script>
</body>
</html>
